Pythonè·¯å¾„:  /home/zhengxin.guo/project/venvs/anomaly-DPS/bin/python
Pythonç‰ˆæœ¬:  Python 3.12.3
=== ä»»åŠ¡å¼€å§‹ ===
è„šæœ¬è·¯å¾„: scripts/anomaly_detection/ModernTCN//SMAP.sh
GPU available: NVIDIA GeForce RTX 2070 SUPER
Total GPUs: 1
Primary GPU: cuda:0
Args in experiment:
[1mBasic Config[0m
  Task Name:          anomaly_detection   Is Training:        1                   
  Model ID:           SMAP                Model:              ModernTCN           

[1mData Loader[0m
  Data:               SMAP                Root Path:          ./dataset/SMAP      
  Data Path:          SMD_test.npy        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mAnomaly Detection Task[0m
  Anomaly Ratio:      1.0                 

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             25                  Dec In:             7                   
  C Out:              25                  d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
Adjust embed_dim to 75 to be divisible by nvars 25
>>>>>>> start training : anomaly_detection_SMAP_ModernTCN_SMAP_ftM_sl100_ll48_pl0_dm16_nh8_el2_dl1_df16_expand2_dc4_fc1_ebtimeF_dtTrue_test_0 >>>>>>>>>>>>>>>>>>
test: (427617, 25)
train: (135183, 25)
train 135084
test: (427617, 25)
train: (135183, 25)
val 26938
test: (427617, 25)
train: (135183, 25)
test 427518
	iters: 100, epoch: 1 | loss: 1.2019454
	speed: 0.0472s/iter; left time: 2486.0299s
	iters: 200, epoch: 1 | loss: 0.6281627
	speed: 0.0129s/iter; left time: 677.5401s
	iters: 300, epoch: 1 | loss: 0.4577631
	speed: 0.0123s/iter; left time: 646.3695s
	iters: 400, epoch: 1 | loss: 0.5455903
	speed: 0.0124s/iter; left time: 647.5767s
	iters: 500, epoch: 1 | loss: 0.4656134
	speed: 0.0114s/iter; left time: 593.7499s
	iters: 600, epoch: 1 | loss: 0.4136815
	speed: 0.0117s/iter; left time: 610.0128s
	iters: 700, epoch: 1 | loss: 0.2998595
	speed: 0.0125s/iter; left time: 653.6940s
	iters: 800, epoch: 1 | loss: 0.7617933
	speed: 0.0125s/iter; left time: 648.4446s
	iters: 900, epoch: 1 | loss: 0.3205605
	speed: 0.0126s/iter; left time: 655.7311s
	iters: 1000, epoch: 1 | loss: 0.7922881
	speed: 0.0120s/iter; left time: 619.6853s
Epoch: 1 cost time: 16.51610255241394
Epoch: 1, Steps: 1056 | Train Loss: 0.5604574 Vali Loss: 0.1548551 Test Loss: 0.5677373
Validation loss decreased (inf --> 0.154855).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4047143
	speed: 0.2313s/iter; left time: 11942.9197s
	iters: 200, epoch: 2 | loss: 0.3163911
	speed: 0.0119s/iter; left time: 615.2920s
	iters: 300, epoch: 2 | loss: 0.3054282
	speed: 0.0135s/iter; left time: 692.2976s
	iters: 400, epoch: 2 | loss: 0.2546017
	speed: 0.0125s/iter; left time: 643.1446s
	iters: 500, epoch: 2 | loss: 0.1622974
	speed: 0.0125s/iter; left time: 641.1259s
	iters: 600, epoch: 2 | loss: 0.3690800
	speed: 0.0124s/iter; left time: 634.5025s
	iters: 700, epoch: 2 | loss: 0.1783803
	speed: 0.0119s/iter; left time: 609.2276s
	iters: 800, epoch: 2 | loss: 0.2231317
	speed: 0.0126s/iter; left time: 640.5651s
	iters: 900, epoch: 2 | loss: 0.4226383
	speed: 0.0122s/iter; left time: 621.4112s
	iters: 1000, epoch: 2 | loss: 0.2233882
	speed: 0.0125s/iter; left time: 634.8862s
Epoch: 2 cost time: 14.851323366165161
Epoch: 2, Steps: 1056 | Train Loss: 0.2935776 Vali Loss: 0.1164431 Test Loss: 0.5652289
Validation loss decreased (0.154855 --> 0.116443).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3661097
	speed: 0.3016s/iter; left time: 15256.9972s
	iters: 200, epoch: 3 | loss: 0.1786818
	speed: 0.0124s/iter; left time: 624.7046s
	iters: 300, epoch: 3 | loss: 0.2842748
	speed: 0.0127s/iter; left time: 641.6364s
	iters: 400, epoch: 3 | loss: 0.1735310
	speed: 0.0123s/iter; left time: 617.0759s
	iters: 500, epoch: 3 | loss: 0.2759021
	speed: 0.0125s/iter; left time: 625.1384s
	iters: 600, epoch: 3 | loss: 0.2008534
	speed: 0.0125s/iter; left time: 626.4322s
	iters: 700, epoch: 3 | loss: 0.1792445
	speed: 0.0119s/iter; left time: 597.0087s
	iters: 800, epoch: 3 | loss: 0.2971789
	speed: 0.0122s/iter; left time: 609.1900s
	iters: 900, epoch: 3 | loss: 0.1538713
	speed: 0.0118s/iter; left time: 588.0762s
	iters: 1000, epoch: 3 | loss: 0.2651045
	speed: 0.0123s/iter; left time: 613.3950s
Epoch: 3 cost time: 14.796884059906006
Epoch: 3, Steps: 1056 | Train Loss: 0.2355498 Vali Loss: 0.1070168 Test Loss: 0.5592602
Validation loss decreased (0.116443 --> 0.107017).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4981536
	speed: 0.3141s/iter; left time: 15556.7750s
	iters: 200, epoch: 4 | loss: 0.1593385
	speed: 0.0126s/iter; left time: 624.6234s
	iters: 300, epoch: 4 | loss: 0.1723976
	speed: 0.0123s/iter; left time: 606.7699s
	iters: 400, epoch: 4 | loss: 0.2815098
	speed: 0.0123s/iter; left time: 607.9917s
	iters: 500, epoch: 4 | loss: 0.3449384
	speed: 0.0124s/iter; left time: 608.2216s
	iters: 600, epoch: 4 | loss: 0.1679311
	speed: 0.0127s/iter; left time: 621.3831s
	iters: 700, epoch: 4 | loss: 0.1717415
	speed: 0.0128s/iter; left time: 627.9293s
	iters: 800, epoch: 4 | loss: 0.2373244
	speed: 0.0120s/iter; left time: 586.0725s
	iters: 900, epoch: 4 | loss: 0.1569682
	speed: 0.0118s/iter; left time: 576.4827s
	iters: 1000, epoch: 4 | loss: 0.2565463
	speed: 0.0126s/iter; left time: 611.0227s
Epoch: 4 cost time: 15.021738290786743
Epoch: 4, Steps: 1056 | Train Loss: 0.2184170 Vali Loss: 0.1032355 Test Loss: 0.5482488
Validation loss decreased (0.107017 --> 0.103236).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5191406
	speed: 0.3172s/iter; left time: 15374.5663s
	iters: 200, epoch: 5 | loss: 0.1466632
	speed: 0.0123s/iter; left time: 592.8935s
	iters: 300, epoch: 5 | loss: 0.1355237
	speed: 0.0125s/iter; left time: 603.2445s
	iters: 400, epoch: 5 | loss: 0.2291004
	speed: 0.0126s/iter; left time: 606.5968s
	iters: 500, epoch: 5 | loss: 0.1440774
	speed: 0.0126s/iter; left time: 604.4542s
	iters: 600, epoch: 5 | loss: 0.1401759
	speed: 0.0129s/iter; left time: 618.1401s
	iters: 700, epoch: 5 | loss: 0.1711555
	speed: 0.0130s/iter; left time: 622.3102s
	iters: 800, epoch: 5 | loss: 0.1547559
	speed: 0.0122s/iter; left time: 582.2571s
	iters: 900, epoch: 5 | loss: 0.3371008
	speed: 0.0123s/iter; left time: 587.5675s
	iters: 1000, epoch: 5 | loss: 0.1713682
	speed: 0.0123s/iter; left time: 583.4301s
Epoch: 5 cost time: 14.9691162109375
Epoch: 5, Steps: 1056 | Train Loss: 0.2113224 Vali Loss: 0.1015660 Test Loss: 0.5455987
Validation loss decreased (0.103236 --> 0.101566).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1691612
	speed: 0.3147s/iter; left time: 14924.6019s
	iters: 200, epoch: 6 | loss: 0.2728321
	speed: 0.0125s/iter; left time: 589.2503s
	iters: 300, epoch: 6 | loss: 0.3434691
	speed: 0.0126s/iter; left time: 594.2020s
	iters: 400, epoch: 6 | loss: 0.5988592
	speed: 0.0120s/iter; left time: 565.5719s
	iters: 500, epoch: 6 | loss: 0.1937621
	speed: 0.0127s/iter; left time: 596.9382s
	iters: 600, epoch: 6 | loss: 0.1731700
	speed: 0.0126s/iter; left time: 590.1414s
	iters: 700, epoch: 6 | loss: 0.1140944
	speed: 0.0124s/iter; left time: 582.4417s
	iters: 800, epoch: 6 | loss: 0.2035432
	speed: 0.0122s/iter; left time: 571.4901s
	iters: 900, epoch: 6 | loss: 0.1908567
	speed: 0.0126s/iter; left time: 588.1690s
	iters: 1000, epoch: 6 | loss: 0.2016053
	speed: 0.0113s/iter; left time: 524.5923s
Epoch: 6 cost time: 14.930994987487793
Epoch: 6, Steps: 1056 | Train Loss: 0.2077137 Vali Loss: 0.1007708 Test Loss: 0.5452388
Validation loss decreased (0.101566 --> 0.100771).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3041355
	speed: 0.3163s/iter; left time: 14664.8830s
	iters: 200, epoch: 7 | loss: 0.1914081
	speed: 0.0125s/iter; left time: 578.9865s
	iters: 300, epoch: 7 | loss: 0.2822711
	speed: 0.0127s/iter; left time: 585.1594s
	iters: 400, epoch: 7 | loss: 0.1847569
	speed: 0.0121s/iter; left time: 556.1315s
	iters: 500, epoch: 7 | loss: 0.1572349
	speed: 0.0121s/iter; left time: 556.3308s
	iters: 600, epoch: 7 | loss: 0.1270784
	speed: 0.0122s/iter; left time: 560.3407s
	iters: 700, epoch: 7 | loss: 0.1414226
	speed: 0.0120s/iter; left time: 546.9506s
	iters: 800, epoch: 7 | loss: 0.2346069
	speed: 0.0118s/iter; left time: 539.0854s
	iters: 900, epoch: 7 | loss: 0.2568191
	speed: 0.0126s/iter; left time: 572.6221s
	iters: 1000, epoch: 7 | loss: 0.1411237
	speed: 0.0125s/iter; left time: 569.1812s
Epoch: 7 cost time: 14.892782926559448
Epoch: 7, Steps: 1056 | Train Loss: 0.2060243 Vali Loss: 0.1001901 Test Loss: 0.5454060
Validation loss decreased (0.100771 --> 0.100190).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1584125
	speed: 0.3153s/iter; left time: 14286.9264s
	iters: 200, epoch: 8 | loss: 0.2156451
	speed: 0.0126s/iter; left time: 570.0651s
	iters: 300, epoch: 8 | loss: 0.2862867
	speed: 0.0122s/iter; left time: 549.7929s
	iters: 400, epoch: 8 | loss: 0.3452269
	speed: 0.0123s/iter; left time: 555.2902s
	iters: 500, epoch: 8 | loss: 0.1386228
	speed: 0.0122s/iter; left time: 548.4660s
	iters: 600, epoch: 8 | loss: 0.2002881
	speed: 0.0125s/iter; left time: 558.6902s
	iters: 700, epoch: 8 | loss: 0.1674759
	speed: 0.0126s/iter; left time: 565.3710s
	iters: 800, epoch: 8 | loss: 0.2747934
	speed: 0.0125s/iter; left time: 557.0369s
	iters: 900, epoch: 8 | loss: 0.1978039
	speed: 0.0125s/iter; left time: 558.0400s
	iters: 1000, epoch: 8 | loss: 0.1917487
	speed: 0.0123s/iter; left time: 547.9793s
Epoch: 8 cost time: 14.989167928695679
Epoch: 8, Steps: 1056 | Train Loss: 0.2051573 Vali Loss: 0.1000895 Test Loss: 0.5421243
Validation loss decreased (0.100190 --> 0.100089).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1853703
	speed: 0.3161s/iter; left time: 13989.4731s
	iters: 200, epoch: 9 | loss: 0.1172972
	speed: 0.0128s/iter; left time: 565.5302s
	iters: 300, epoch: 9 | loss: 0.1533214
	speed: 0.0122s/iter; left time: 539.2723s
	iters: 400, epoch: 9 | loss: 0.2262557
	speed: 0.0124s/iter; left time: 545.9362s
	iters: 500, epoch: 9 | loss: 0.1386074
	speed: 0.0120s/iter; left time: 528.1304s
	iters: 600, epoch: 9 | loss: 0.2188278
	speed: 0.0125s/iter; left time: 548.8716s
	iters: 700, epoch: 9 | loss: 0.1637594
	speed: 0.0124s/iter; left time: 540.4498s
	iters: 800, epoch: 9 | loss: 0.2246476
	speed: 0.0118s/iter; left time: 513.0833s
	iters: 900, epoch: 9 | loss: 0.2697032
	speed: 0.0119s/iter; left time: 518.4491s
	iters: 1000, epoch: 9 | loss: 0.3210964
	speed: 0.0116s/iter; left time: 503.0078s
Epoch: 9 cost time: 14.778188228607178
Epoch: 9, Steps: 1056 | Train Loss: 0.2048029 Vali Loss: 0.1001154 Test Loss: 0.5428123
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2762884
	speed: 0.3162s/iter; left time: 13657.3001s
	iters: 200, epoch: 10 | loss: 0.1712883
	speed: 0.0128s/iter; left time: 552.7472s
	iters: 300, epoch: 10 | loss: 0.2086446
	speed: 0.0123s/iter; left time: 530.2465s
	iters: 400, epoch: 10 | loss: 0.2333043
	speed: 0.0125s/iter; left time: 534.7063s
	iters: 500, epoch: 10 | loss: 0.2346117
	speed: 0.0121s/iter; left time: 519.0735s
	iters: 600, epoch: 10 | loss: 0.2028138
	speed: 0.0123s/iter; left time: 526.6609s
	iters: 700, epoch: 10 | loss: 0.1805283
	speed: 0.0122s/iter; left time: 518.8736s
	iters: 800, epoch: 10 | loss: 0.1243370
	speed: 0.0124s/iter; left time: 525.9887s
	iters: 900, epoch: 10 | loss: 0.2402658
	speed: 0.0125s/iter; left time: 530.7671s
	iters: 1000, epoch: 10 | loss: 0.2835647
	speed: 0.0122s/iter; left time: 514.0627s
Epoch: 10 cost time: 15.041839838027954
Epoch: 10, Steps: 1056 | Train Loss: 0.2047274 Vali Loss: 0.0999361 Test Loss: 0.5433618
Validation loss decreased (0.100089 --> 0.099936).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1943709
	speed: 0.3160s/iter; left time: 13316.5382s
	iters: 200, epoch: 11 | loss: 0.1323794
	speed: 0.0129s/iter; left time: 540.9922s
	iters: 300, epoch: 11 | loss: 0.2135477
	speed: 0.0125s/iter; left time: 523.9526s
	iters: 400, epoch: 11 | loss: 0.2437206
	speed: 0.0126s/iter; left time: 526.9776s
	iters: 500, epoch: 11 | loss: 0.1360369
	speed: 0.0114s/iter; left time: 473.8694s
	iters: 600, epoch: 11 | loss: 0.1552028
	speed: 0.0125s/iter; left time: 519.7997s
	iters: 700, epoch: 11 | loss: 0.2707609
	speed: 0.0126s/iter; left time: 523.7838s
	iters: 800, epoch: 11 | loss: 0.1663102
	speed: 0.0129s/iter; left time: 536.2475s
	iters: 900, epoch: 11 | loss: 0.3371556
	speed: 0.0127s/iter; left time: 526.5573s
	iters: 1000, epoch: 11 | loss: 0.2223509
	speed: 0.0119s/iter; left time: 491.5997s
Epoch: 11 cost time: 15.13349986076355
Epoch: 11, Steps: 1056 | Train Loss: 0.2042715 Vali Loss: 0.0998734 Test Loss: 0.5446376
Validation loss decreased (0.099936 --> 0.099873).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.2335763
	speed: 0.3172s/iter; left time: 13030.3198s
	iters: 200, epoch: 12 | loss: 0.1482267
	speed: 0.0120s/iter; left time: 492.9614s
	iters: 300, epoch: 12 | loss: 0.1461336
	speed: 0.0132s/iter; left time: 540.0863s
	iters: 400, epoch: 12 | loss: 0.1937626
	speed: 0.0127s/iter; left time: 517.4878s
	iters: 500, epoch: 12 | loss: 0.1131785
	speed: 0.0122s/iter; left time: 497.1557s
	iters: 600, epoch: 12 | loss: 0.1344988
	speed: 0.0124s/iter; left time: 501.4692s
	iters: 700, epoch: 12 | loss: 0.1696841
	speed: 0.0136s/iter; left time: 550.7157s
	iters: 800, epoch: 12 | loss: 0.2628478
	speed: 0.0128s/iter; left time: 516.9333s
	iters: 900, epoch: 12 | loss: 0.1801372
	speed: 0.0126s/iter; left time: 507.1696s
	iters: 1000, epoch: 12 | loss: 0.1640723
	speed: 0.0127s/iter; left time: 510.3425s
Epoch: 12 cost time: 15.358288049697876
Epoch: 12, Steps: 1056 | Train Loss: 0.2042940 Vali Loss: 0.0996863 Test Loss: 0.5444044
Validation loss decreased (0.099873 --> 0.099686).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1642011
	speed: 0.3178s/iter; left time: 12720.5218s
	iters: 200, epoch: 13 | loss: 0.2441924
	speed: 0.0125s/iter; left time: 499.6589s
	iters: 300, epoch: 13 | loss: 0.2212750
	speed: 0.0130s/iter; left time: 516.6686s
	iters: 400, epoch: 13 | loss: 0.1409540
	speed: 0.0126s/iter; left time: 501.9198s
	iters: 500, epoch: 13 | loss: 0.1891230
	speed: 0.0128s/iter; left time: 508.6026s
	iters: 600, epoch: 13 | loss: 0.2324070
	speed: 0.0127s/iter; left time: 501.0537s
	iters: 700, epoch: 13 | loss: 0.2232059
	speed: 0.0124s/iter; left time: 488.2596s
	iters: 800, epoch: 13 | loss: 0.1686731
	speed: 0.0124s/iter; left time: 487.4415s
	iters: 900, epoch: 13 | loss: 0.1577994
	speed: 0.0121s/iter; left time: 474.6556s
	iters: 1000, epoch: 13 | loss: 0.1626197
	speed: 0.0124s/iter; left time: 483.5189s
Epoch: 13 cost time: 15.240659236907959
Epoch: 13, Steps: 1056 | Train Loss: 0.2043076 Vali Loss: 0.0999842 Test Loss: 0.5444293
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1917630
	speed: 0.3176s/iter; left time: 12379.0755s
	iters: 200, epoch: 14 | loss: 0.1996681
	speed: 0.0128s/iter; left time: 496.1736s
	iters: 300, epoch: 14 | loss: 0.3446530
	speed: 0.0124s/iter; left time: 482.4387s
	iters: 400, epoch: 14 | loss: 0.1860949
	speed: 0.0127s/iter; left time: 491.8717s
	iters: 500, epoch: 14 | loss: 0.1328876
	speed: 0.0131s/iter; left time: 506.0282s
	iters: 600, epoch: 14 | loss: 0.3080956
	speed: 0.0128s/iter; left time: 492.7662s
	iters: 700, epoch: 14 | loss: 0.1413709
	speed: 0.0126s/iter; left time: 483.9603s
	iters: 800, epoch: 14 | loss: 0.2699360
	speed: 0.0115s/iter; left time: 441.3762s
	iters: 900, epoch: 14 | loss: 0.1376749
	speed: 0.0119s/iter; left time: 454.4477s
	iters: 1000, epoch: 14 | loss: 0.1603914
	speed: 0.0126s/iter; left time: 479.5831s
Epoch: 14 cost time: 15.08903980255127
Epoch: 14, Steps: 1056 | Train Loss: 0.2044036 Vali Loss: 0.0999781 Test Loss: 0.5429227
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.2262837
	speed: 0.3177s/iter; left time: 12047.3959s
	iters: 200, epoch: 15 | loss: 0.1863231
	speed: 0.0126s/iter; left time: 477.9132s
	iters: 300, epoch: 15 | loss: 0.1336867
	speed: 0.0121s/iter; left time: 456.8222s
	iters: 400, epoch: 15 | loss: 0.2098391
	speed: 0.0125s/iter; left time: 468.6068s
	iters: 500, epoch: 15 | loss: 0.1465413
	speed: 0.0125s/iter; left time: 469.4471s
	iters: 600, epoch: 15 | loss: 0.2369049
	speed: 0.0124s/iter; left time: 465.3027s
	iters: 700, epoch: 15 | loss: 0.2091900
	speed: 0.0126s/iter; left time: 468.6888s
	iters: 800, epoch: 15 | loss: 0.1727269
	speed: 0.0124s/iter; left time: 461.5858s
	iters: 900, epoch: 15 | loss: 0.2011803
	speed: 0.0121s/iter; left time: 450.0647s
	iters: 1000, epoch: 15 | loss: 0.1932490
	speed: 0.0118s/iter; left time: 436.4179s
Epoch: 15 cost time: 15.021031379699707
Epoch: 15, Steps: 1056 | Train Loss: 0.2043208 Vali Loss: 0.0995807 Test Loss: 0.5451185
Validation loss decreased (0.099686 --> 0.099581).  Saving model ...
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.1747620
	speed: 0.3184s/iter; left time: 11737.3280s
	iters: 200, epoch: 16 | loss: 0.1412642
	speed: 0.0128s/iter; left time: 472.1961s
	iters: 300, epoch: 16 | loss: 0.2163097
	speed: 0.0125s/iter; left time: 459.3664s
	iters: 400, epoch: 16 | loss: 0.1465304
	speed: 0.0120s/iter; left time: 438.4804s
	iters: 500, epoch: 16 | loss: 0.2282369
	speed: 0.0124s/iter; left time: 453.5857s
	iters: 600, epoch: 16 | loss: 0.1918934
	speed: 0.0130s/iter; left time: 471.8804s
	iters: 700, epoch: 16 | loss: 0.1986473
	speed: 0.0126s/iter; left time: 456.5485s
	iters: 800, epoch: 16 | loss: 0.1608011
	speed: 0.0122s/iter; left time: 441.2505s
	iters: 900, epoch: 16 | loss: 0.1653993
	speed: 0.0130s/iter; left time: 469.9948s
	iters: 1000, epoch: 16 | loss: 0.1770027
	speed: 0.0131s/iter; left time: 470.5845s
Epoch: 16 cost time: 15.299591541290283
Epoch: 16, Steps: 1056 | Train Loss: 0.2044639 Vali Loss: 0.0995163 Test Loss: 0.5481368
Validation loss decreased (0.099581 --> 0.099516).  Saving model ...
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.2150740
	speed: 0.3162s/iter; left time: 11322.7060s
	iters: 200, epoch: 17 | loss: 0.2155945
	speed: 0.0126s/iter; left time: 451.6553s
	iters: 300, epoch: 17 | loss: 0.2055527
	speed: 0.0124s/iter; left time: 441.9326s
	iters: 400, epoch: 17 | loss: 0.1863864
	speed: 0.0129s/iter; left time: 456.7473s
	iters: 500, epoch: 17 | loss: 0.2094954
	speed: 0.0122s/iter; left time: 432.4575s
	iters: 600, epoch: 17 | loss: 0.1377331
	speed: 0.0125s/iter; left time: 442.9780s
	iters: 700, epoch: 17 | loss: 0.2733770
	speed: 0.0125s/iter; left time: 440.6620s
	iters: 800, epoch: 17 | loss: 0.1729282
	speed: 0.0125s/iter; left time: 437.8475s
	iters: 900, epoch: 17 | loss: 0.1976095
	speed: 0.0124s/iter; left time: 433.9421s
	iters: 1000, epoch: 17 | loss: 0.1514355
	speed: 0.0123s/iter; left time: 428.6950s
Epoch: 17 cost time: 15.048128843307495
Epoch: 17, Steps: 1056 | Train Loss: 0.2045359 Vali Loss: 0.1000365 Test Loss: 0.5438520
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.52587890625e-09
	iters: 100, epoch: 18 | loss: 0.1361294
	speed: 0.3167s/iter; left time: 11004.7795s
	iters: 200, epoch: 18 | loss: 0.1691175
	speed: 0.0132s/iter; left time: 458.6316s
	iters: 300, epoch: 18 | loss: 0.1746868
	speed: 0.0126s/iter; left time: 435.2310s
	iters: 400, epoch: 18 | loss: 0.1464298
	speed: 0.0117s/iter; left time: 404.1295s
	iters: 500, epoch: 18 | loss: 0.1988903
	speed: 0.0125s/iter; left time: 430.8141s
	iters: 600, epoch: 18 | loss: 0.1363881
	speed: 0.0124s/iter; left time: 426.2046s
	iters: 700, epoch: 18 | loss: 0.1849022
	speed: 0.0126s/iter; left time: 430.5732s
	iters: 800, epoch: 18 | loss: 0.1246658
	speed: 0.0128s/iter; left time: 435.7310s
	iters: 900, epoch: 18 | loss: 0.2172696
	speed: 0.0136s/iter; left time: 461.6764s
	iters: 1000, epoch: 18 | loss: 0.1657098
	speed: 0.0121s/iter; left time: 409.7386s
Epoch: 18 cost time: 15.229471683502197
Epoch: 18, Steps: 1056 | Train Loss: 0.2042706 Vali Loss: 0.0998816 Test Loss: 0.5444024
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.62939453125e-10
	iters: 100, epoch: 19 | loss: 0.1802291
	speed: 0.3163s/iter; left time: 10657.6983s
	iters: 200, epoch: 19 | loss: 0.2022430
	speed: 0.0130s/iter; left time: 438.3014s
	iters: 300, epoch: 19 | loss: 0.1425914
	speed: 0.0135s/iter; left time: 452.4116s
	iters: 400, epoch: 19 | loss: 0.1827013
	speed: 0.0135s/iter; left time: 449.2460s
	iters: 500, epoch: 19 | loss: 0.2368809
	speed: 0.0138s/iter; left time: 460.3693s
	iters: 600, epoch: 19 | loss: 0.2420878
	speed: 0.0126s/iter; left time: 416.7781s
	iters: 700, epoch: 19 | loss: 0.2066038
	speed: 0.0128s/iter; left time: 424.9623s
	iters: 800, epoch: 19 | loss: 0.2040570
	speed: 0.0127s/iter; left time: 417.8375s
	iters: 900, epoch: 19 | loss: 0.1263050
	speed: 0.0121s/iter; left time: 398.7985s
	iters: 1000, epoch: 19 | loss: 0.1706945
	speed: 0.0128s/iter; left time: 419.8159s
Epoch: 19 cost time: 15.52634334564209
Epoch: 19, Steps: 1056 | Train Loss: 0.2043306 Vali Loss: 0.0997458 Test Loss: 0.5452845
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>> testing : anomaly_detection_SMAP_ModernTCN_SMAP_ftM_sl100_ll48_pl0_dm16_nh8_el2_dl1_df16_expand2_dc4_fc1_ebtimeF_dtTrue_test_0 <<<<<<<<<<<<<<<<<<<<<<<<<
test: (427617, 25)
train: (135183, 25)
test 427518
test: (427617, 25)
train: (135183, 25)
train 135084
Threshold : 2.1620746
pred:    (42751800,)
gt:      (42751800,)
pred:  (42751800,)
gt:    (42751800,)
Accuracy : 0.9349, Precision : 0.9025, Recall : 0.5510, F-score : 0.6842 

real	14m17.477s
user	27m55.733s
sys	23m49.503s
=== ä»»åŠ¡ç»“æŸ ===
é€€å‡ºçŠ¶æ€: 0
æ€»è€—æ—¶: 858 ç§’
